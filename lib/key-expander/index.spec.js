'use strict';

const expect = require('chai').expect;
const KeyExpander = require('.');

describe('KeyExpander', () => {

  describe('#getRoundKey', () => {

    [
      { round: 0, expected: [
          [0x2b, 0x28, 0xab, 0x09],
          [0x7e, 0xae, 0xf7, 0xcf],
          [0x15, 0xd2, 0x15, 0x4f],
          [0x16, 0xa6, 0x88, 0x3c]
        ]
      },
      { round: 1, expected: [
          [0xa0, 0x88, 0x23, 0x2a],
          [0xfa, 0x54, 0xa3, 0x6c],
          [0xfe, 0x2c, 0x39, 0x76],
          [0x17, 0xb1, 0x39, 0x05]
        ]
      },
      { round: 2, expected: [
          [0xf2, 0x7a, 0x59, 0x73],
          [0xc2, 0x96, 0x35, 0x59],
          [0x95, 0xb9, 0x80, 0xf6],
          [0xf2, 0x43, 0x7a, 0x7f]
        ]
      },
      { round: 10, expected: [
          [0xd0, 0xc9, 0xe1, 0xb6],
          [0x14, 0xee, 0x3f, 0x63],
          [0xf9, 0x25, 0x0c, 0x0c],
          [0xa8, 0x89, 0xc8, 0xa6]
        ]
      }
    ].forEach((testCase) => {
      it('returns the correct round key for round #' + testCase.round, () => {
        let key = [
          [0x2b, 0x28, 0xab, 0x09],
          [0x7e, 0xae, 0xf7, 0xcf],
          [0x15, 0xd2, 0x15, 0x4f],
          [0x16, 0xa6, 0x88, 0x3c]
        ];
        let expander = new KeyExpander(key);

        expect(expander.getRoundKey(testCase.round)).to.eql(testCase.expected);
      });
    })

  });

});
